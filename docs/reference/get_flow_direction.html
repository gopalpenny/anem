<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Calculate the flow direction — get_flow_direction • anem</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Calculate the flow direction — get_flow_direction" />
<meta property="og:description" content="Calculates the derivative of hydraulic head in x and y directions, returning \(-dh/dx\)
  and \(-dh/dy\). For confined aquifers, the result is calculated using the sum of the
  effect of each analytical element, whereas for unconfined aquifers the result can be calculated
  analytically or numerically from hydraulic head." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">anem</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/anem-vignette.html">anem-vignette</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate the flow direction</h1>
    
    <div class="hidden name"><code>get_flow_direction.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculates the derivative of hydraulic head in x and y directions, returning \(-dh/dx\)
  and \(-dh/dy\). For confined aquifers, the result is calculated using the sum of the
  effect of each analytical element, whereas for unconfined aquifers the result can be calculated
  analytically or numerically from hydraulic head.</p>
    </div>

    <pre class="usage"><span class='fu'>get_flow_direction</span>(<span class='no'>loc</span>, <span class='no'>wells</span>, <span class='no'>aquifer</span>, <span class='kw'>show_progress</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>eps</span> <span class='kw'>=</span> <span class='fl'>1e-06</span>, <span class='kw'>numderiv</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>loc</th>
      <td><p>coordinates vector as c(x,y), with units of [m] or as data.frame with columns $x and $y</p></td>
    </tr>
    <tr>
      <th>wells</th>
      <td><p>wells object with each row containing rate Q [m^3/s], diam [m],
radius of influence R [m], &amp; coordinates x [m], y [m]</p></td>
    </tr>
    <tr>
      <th>aquifer</th>
      <td><p>Afuifer object containing aquifer_type, h0, Ksat, bounds, z0 (for confined case only)</p></td>
    </tr>
    <tr>
      <th>show_progress</th>
      <td><p>Boolean input parameter. If true and there are &gt;20 combinations of
wells and locations, then a progress bar will be printed.</p></td>
    </tr>
    <tr>
      <th>eps</th>
      <td><p>Threshold satisfying numeric derivative</p></td>
    </tr>
    <tr>
      <th>numderiv</th>
      <td><p>Boolean that determines whether unconfined aquifers are calculated analytically or numerically</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Outputs the flow direction in the x and y directions. If the input <code>loc</code> is
  a numeric <code><a href='https://rdrr.io/r/base/c.html'>c(x,y)</a></code>, then the output is in the same format. If the input is a data.frame,
  then the output is also a data.frame with columns <code>dx</code> and <code>dy</code>. The two values
  indicate the flow direction, and are equivalent to \(-dh/dx\)
  and \(-dh/dy\).</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>wells</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='define_wells.html'>define_wells</a></span>(<span class='kw'>x</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>,<span class='fl'>0.5</span>),<span class='kw'>y</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>,<span class='fl'>0.25</span>),<span class='kw'>Q</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1e-3</span>,-<span class='fl'>2e-3</span>),<span class='kw'>diam</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.75</span>,<span class='fl'>0.8</span>),<span class='kw'>R</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>300</span>,<span class='fl'>300</span>))
<span class='no'>aquifer</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='define_aquifer.html'>define_aquifer</a></span>(<span class='kw'>h0</span><span class='kw'>=</span><span class='fl'>0</span>,<span class='kw'>Ksat</span><span class='kw'>=</span><span class='fl'>0.00001</span>,<span class='kw'>z0</span><span class='kw'>=</span><span class='fl'>30</span>,<span class='kw'>aquifer_type</span><span class='kw'>=</span><span class='st'>"confined"</span>)
<span class='fu'>get_flow_direction</span>(<span class='kw'>loc</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>5</span>,<span class='fl'>5</span>),<span class='no'>wells</span>,<span class='no'>aquifer</span>)</div><div class='output co'>#&gt; [1] -0.05847298 -0.06466880</div><div class='input'>
<span class='no'>grid_pts</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span>(<span class='kw'>x</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>10</span>,<span class='kw'>by</span><span class='kw'>=</span><span class='fl'>5</span>),<span class='kw'>y</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>10</span>,<span class='kw'>by</span><span class='kw'>=</span><span class='fl'>5</span>))
<span class='fu'>get_flow_direction</span>(<span class='kw'>loc</span><span class='kw'>=</span><span class='no'>grid_pts</span>,<span class='no'>wells</span>,<span class='no'>aquifer</span>)</div><div class='output co'>#&gt;             dx           dy
#&gt; 1  1.697652726  0.848826363
#&gt; 2 -0.128956313  0.013058867
#&gt; 3 -0.058558739  0.002937115
#&gt; 4  0.023255517 -0.114824114
#&gt; 5 -0.058472984 -0.064668797
#&gt; 6 -0.046908825 -0.023454413
#&gt; 7  0.005566075 -0.055486805
#&gt; 8 -0.020185505 -0.047272037
#&gt; 9 -0.027867771 -0.029299181</div><div class='input'>
<span class='co'># Injection and pumping well along diagonal line</span>
<span class='no'>wells2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='kw'>x</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(-<span class='fl'>10</span>,<span class='fl'>10</span>),<span class='kw'>y</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(-<span class='fl'>10</span>,<span class='fl'>10</span>),<span class='kw'>Q</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1e-3</span>,-<span class='fl'>1e-3</span>),<span class='kw'>diam</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.1</span>,<span class='fl'>0.1</span>),<span class='kw'>R</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>300</span>,<span class='fl'>300</span>))
<span class='no'>grid_pts2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='kw'>x</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(-<span class='fl'>11</span>,<span class='fl'>0</span>,<span class='fl'>11</span>),<span class='kw'>y</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(-<span class='fl'>11</span>,<span class='fl'>0</span>,<span class='fl'>11</span>))
<span class='no'>aquifer_unconfined</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='define_aquifer.html'>define_aquifer</a></span>(<span class='kw'>aquifer_type</span><span class='kw'>=</span><span class='st'>"unconfined"</span>,<span class='kw'>Ksat</span><span class='kw'>=</span><span class='fl'>0.00001</span>,<span class='kw'>h0</span><span class='kw'>=</span><span class='fl'>20</span>)
<span class='no'>fd2_a</span> <span class='kw'>&lt;-</span> <span class='fu'>get_flow_direction</span>(<span class='kw'>loc</span><span class='kw'>=</span><span class='no'>grid_pts2</span>,<span class='no'>wells2</span>,<span class='no'>aquifer_unconfined</span>)
<span class='no'>fd2_b</span> <span class='kw'>&lt;-</span> <span class='fu'>get_flow_direction</span>(<span class='kw'>loc</span><span class='kw'>=</span><span class='no'>grid_pts2</span>,<span class='no'>wells2</span>,<span class='no'>aquifer_unconfined</span>,<span class='kw'>numderiv</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='no'>fd2_a</span> - <span class='no'>fd2_b</span></div><div class='output co'>#&gt;              dx            dy
#&gt; 1 -3.736863e-09 -3.736863e-09
#&gt; 2 -1.773212e-10 -1.773212e-10
#&gt; 3 -4.489571e-09 -4.489571e-09</div><div class='input'>
<span class='co'># Two pumping wells along diagonal line</span>
<span class='no'>wells3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='kw'>x</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(-<span class='fl'>10</span>,<span class='fl'>10</span>),<span class='kw'>y</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(-<span class='fl'>10</span>,<span class='fl'>10</span>),<span class='kw'>Q</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(-<span class='fl'>1e-3</span>,-<span class='fl'>1e-3</span>),<span class='kw'>diam</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.1</span>,<span class='fl'>0.1</span>),<span class='kw'>R</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>300</span>,<span class='fl'>300</span>))
<span class='no'>grid_pts3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='kw'>x</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(-<span class='fl'>3</span>,-<span class='fl'>3</span>,<span class='fl'>0</span>,<span class='fl'>3</span>,<span class='fl'>3</span>,-<span class='fl'>2</span>,<span class='fl'>2</span>,-<span class='fl'>1</span>,<span class='fl'>1</span>),<span class='kw'>y</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(-<span class='fl'>3</span>,<span class='fl'>3</span>,<span class='fl'>0</span>,-<span class='fl'>3</span>,<span class='fl'>3</span>,-<span class='fl'>1</span>,<span class='fl'>1</span>,-<span class='fl'>2</span>,<span class='fl'>2</span>))
<span class='no'>fd3</span> <span class='kw'>&lt;-</span> <span class='fu'>get_flow_direction</span>(<span class='no'>wells3</span>,<span class='kw'>loc</span><span class='kw'>=</span><span class='no'>grid_pts3</span>,<span class='no'>aquifer_unconfined</span>)

<span class='co'>## plot the flow directions</span>
<span class='co'># scale dx and dy for visualization</span>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>dplyr</span>)
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>ggplot2</span>)
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>magrittr</span>)
<span class='no'>fd3_grid</span> <span class='kw'>&lt;-</span> <span class='no'>grid_pts3</span> <span class='kw'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>(<span class='no'>fd3</span>) <span class='kw'>%&gt;%</span>
   <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span>(<span class='kw'>dx_norm</span><span class='kw'>=</span><span class='no'>dx</span>*<span class='fl'>50</span>,<span class='kw'>dy_norm</span><span class='kw'>=</span><span class='no'>dy</span>*<span class='fl'>50</span>,<span class='kw'>x2</span><span class='kw'>=</span><span class='no'>x</span>+<span class='no'>dx_norm</span>,<span class='kw'>y2</span><span class='kw'>=</span><span class='no'>y</span>+<span class='no'>dy_norm</span>) <span class='co'># normaliz</span>
<span class='co'># alternatively, apply nonlinear scaling to dx and dy for visualization</span>
<span class='no'>fd3_grid</span> <span class='kw'>&lt;-</span> <span class='no'>grid_pts3</span> <span class='kw'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>(<span class='no'>fd3</span>) <span class='kw'>%&gt;%</span>
<span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span>(<span class='kw'>angle</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>atan</a></span>(<span class='no'>dy</span>/<span class='no'>dx</span>),<span class='kw'>mag</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(<span class='no'>dx</span>^<span class='fl'>2</span>+<span class='no'>dy</span>^<span class='fl'>2</span>),<span class='kw'>mag_norm</span><span class='kw'>=</span><span class='no'>mag</span>^(<span class='fl'>1</span>/<span class='fl'>2</span>)*<span class='fl'>5</span>,
       <span class='kw'>dx_norm</span><span class='kw'>=</span><span class='no'>mag_norm</span>*<span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>cos</a></span>(<span class='no'>angle</span>)*<span class='fu'><a href='https://rdrr.io/r/base/sign.html'>sign</a></span>(<span class='no'>dx</span>),<span class='kw'>dy_norm</span><span class='kw'>=</span><span class='no'>mag_norm</span>*<span class='fu'><a href='https://rdrr.io/r/base/Trig.html'>sin</a></span>(<span class='no'>angle</span>)*<span class='fu'><a href='https://rdrr.io/r/base/sign.html'>sign</a></span>(<span class='no'>dx</span>),
       <span class='kw'>x2</span><span class='kw'>=</span><span class='no'>x</span>+<span class='no'>dx_norm</span>,<span class='kw'>y2</span><span class='kw'>=</span><span class='no'>y</span>+<span class='no'>dy_norm</span>)

<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span>(<span class='no'>fd3_grid</span>,<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span>(<span class='no'>x</span>,<span class='no'>y</span>)) + <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span>(<span class='kw'>size</span><span class='kw'>=</span><span class='fl'>2</span>,<span class='kw'>shape</span><span class='kw'>=</span><span class='fl'>1</span>) +
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span>(<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span>(<span class='kw'>xend</span><span class='kw'>=</span><span class='no'>x2</span>,<span class='kw'>yend</span><span class='kw'>=</span><span class='no'>y2</span>),
    <span class='kw'>arrow</span><span class='kw'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/reexports.html'>arrow</a></span>(<span class='kw'>type</span><span class='kw'>=</span><span class='st'>"closed"</span>,<span class='kw'>length</span><span class='kw'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/reexports.html'>unit</a></span>(<span class='fl'>2</span>,<span class='st'>"mm"</span>))) +
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_fixed.html'>coord_equal</a></span>()</div><div class='output co'>#&gt; <span class='warning'>Warning: Removed 1 rows containing missing values (geom_segment).</span></div><div class='img'><img src='get_flow_direction-1.png' alt='' width='700' height='433' /></div><div class='input'>

<span class='no'>wells</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='define_wells.html'>define_wells</a></span>(<span class='kw'>Q</span><span class='kw'>=</span><span class='fl'>0.1</span>,<span class='kw'>x</span><span class='kw'>=</span>-<span class='fl'>2</span>,<span class='kw'>y</span><span class='kw'>=</span>-<span class='fl'>2</span>,<span class='kw'>R</span><span class='kw'>=</span><span class='fl'>100</span>,<span class='kw'>diam</span><span class='kw'>=</span><span class='fl'>0.5</span>)
<span class='no'>recharge_params</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>recharge_type</span><span class='kw'>=</span><span class='st'>"F"</span>,<span class='kw'>recharge_vector</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>,<span class='fl'>0</span>,-<span class='fl'>1</span>,-<span class='fl'>1</span>),<span class='kw'>flow</span><span class='kw'>=</span><span class='fl'>1e-3</span>,<span class='kw'>x0</span><span class='kw'>=</span><span class='fl'>0</span>,<span class='kw'>y0</span><span class='kw'>=</span><span class='fl'>0</span>)
<span class='no'>aquifer</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='define_aquifer.html'>define_aquifer</a></span>(<span class='st'>"confined"</span>,<span class='fl'>1e-3</span>,<span class='kw'>h0</span><span class='kw'>=</span><span class='fl'>0</span>,<span class='kw'>z0</span><span class='kw'>=</span><span class='fl'>1</span>,<span class='kw'>recharge</span><span class='kw'>=</span><span class='no'>recharge_params</span>)
<span class='fu'>get_flow_direction</span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(-<span class='fl'>1</span>,-<span class='fl'>1</span>),<span class='no'>wells</span>,<span class='no'>aquifer</span>)</div><div class='output co'>#&gt; [1] 7.25064 7.25064</div><div class='input'><span class='fu'>get_flow_direction</span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(-<span class='fl'>1</span>,-<span class='fl'>1</span>),<span class='kw'>NULL</span>,<span class='no'>aquifer</span>)</div><div class='output co'>#&gt; [1] -0.7071068 -0.7071068</div><div class='input'>
<span class='no'>recharge_params</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>recharge_type</span><span class='kw'>=</span><span class='st'>"D"</span>,<span class='kw'>recharge_vector</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>,<span class='fl'>0</span>,-<span class='fl'>1</span>,-<span class='fl'>1</span>),
  <span class='kw'>flow_main</span><span class='kw'>=</span><span class='fl'>1</span>,<span class='kw'>flow_opp</span><span class='kw'>=</span><span class='fl'>1</span>,<span class='kw'>x0</span><span class='kw'>=</span><span class='fl'>0</span>,<span class='kw'>y0</span><span class='kw'>=</span><span class='fl'>0</span>)
<span class='no'>aquifer</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='define_aquifer.html'>define_aquifer</a></span>(<span class='st'>"confined"</span>,<span class='fl'>1</span>,<span class='kw'>h0</span><span class='kw'>=</span><span class='fl'>0</span>,<span class='kw'>z0</span><span class='kw'>=</span><span class='fl'>1</span>,<span class='kw'>recharge</span><span class='kw'>=</span><span class='no'>recharge_params</span>)
<span class='no'>loc</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span>(<span class='kw'>x</span><span class='kw'>=</span>-<span class='fl'>1</span>:<span class='fl'>1</span>,<span class='kw'>y</span><span class='kw'>=</span>-<span class='fl'>1</span>:<span class='fl'>1</span>)
<span class='no'>loc</span> <span class='kw'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/bind.html'>bind_cols</a></span>(<span class='fu'>get_flow_direction</span>(<span class='no'>loc</span>,<span class='no'>wells</span>,<span class='no'>aquifer</span>))</div><div class='output co'>#&gt;    x  y         dx         dy
#&gt; 1 -1 -1 -0.6991490 -0.6991490
#&gt; 2  0 -1 -0.7007406 -0.7039237
#&gt; 3  1 -1 -0.7023321 -0.7055152
#&gt; 4 -1  0 -0.7039237 -0.7007406
#&gt; 5  0  0 -0.7031279 -0.7031279
#&gt; 6  1  0  0.7107796  0.7095553
#&gt; 7 -1  1 -0.7055152 -0.7023321
#&gt; 8  0  1  0.7095553  0.7107796
#&gt; 9  1  1  0.7097594  0.7097594</div><div class='input'><span class='no'>loc</span> <span class='kw'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/bind.html'>bind_cols</a></span>(<span class='fu'>get_flow_direction</span>(<span class='no'>loc</span>,<span class='kw'>NULL</span>,<span class='no'>aquifer</span>))</div><div class='output co'>#&gt;    x  y         dx         dy
#&gt; 1 -1 -1 -0.7071068 -0.7071068
#&gt; 2  0 -1 -0.7071068 -0.7071068
#&gt; 3  1 -1 -0.7071068 -0.7071068
#&gt; 4 -1  0 -0.7071068 -0.7071068
#&gt; 5  0  0 -0.7071068 -0.7071068
#&gt; 6  1  0  0.7071068  0.7071068
#&gt; 7 -1  1 -0.7071068 -0.7071068
#&gt; 8  0  1  0.7071068  0.7071068
#&gt; 9  1  1  0.7071068  0.7071068</div><div class='input'>
<span class='no'>recharge_params</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>recharge_type</span><span class='kw'>=</span><span class='st'>"D"</span>,<span class='kw'>recharge_vector</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>10</span>,<span class='fl'>10</span>,<span class='fl'>11</span>,<span class='fl'>11</span>),
  <span class='kw'>flow_main</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(<span class='fl'>2</span>),<span class='kw'>flow_opp</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(<span class='fl'>2</span>),<span class='kw'>x0</span><span class='kw'>=</span><span class='fl'>0</span>,<span class='kw'>y0</span><span class='kw'>=</span><span class='fl'>0</span>)
<span class='no'>aquifer</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='define_aquifer.html'>define_aquifer</a></span>(<span class='st'>"confined"</span>,<span class='fl'>1</span>,<span class='kw'>h0</span><span class='kw'>=</span><span class='fl'>0</span>,<span class='kw'>z0</span><span class='kw'>=</span><span class='fl'>1</span>,<span class='kw'>recharge</span><span class='kw'>=</span><span class='no'>recharge_params</span>)
<span class='no'>loc</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span>(<span class='kw'>x</span><span class='kw'>=</span><span class='fl'>9</span>:<span class='fl'>11</span>,<span class='kw'>y</span><span class='kw'>=</span><span class='fl'>9</span>:<span class='fl'>11</span>)
<span class='fu'>get_flow_direction</span>(<span class='no'>loc</span>,<span class='no'>wells</span>,<span class='no'>aquifer</span>)</div><div class='output co'>#&gt;           dx         dy
#&gt; 1 -0.9992766 -0.9992766
#&gt; 2 -0.9992793 -0.9993394
#&gt; 3  1.0007135  1.0006037
#&gt; 4 -0.9993394 -0.9992793
#&gt; 5  1.0006631  1.0006631
#&gt; 6  1.0006610  1.0006102
#&gt; 7  1.0006037  1.0007135
#&gt; 8  1.0006102  1.0006610
#&gt; 9  1.0006121  1.0006121</div><div class='input'><span class='fu'>get_flow_direction</span>(<span class='no'>loc</span>,<span class='no'>wells</span>,<span class='no'>aquifer</span>)</div><div class='output co'>#&gt;           dx         dy
#&gt; 1 -0.9992766 -0.9992766
#&gt; 2 -0.9992793 -0.9993394
#&gt; 3  1.0007135  1.0006037
#&gt; 4 -0.9993394 -0.9992793
#&gt; 5  1.0006631  1.0006631
#&gt; 6  1.0006610  1.0006102
#&gt; 7  1.0006037  1.0007135
#&gt; 8  1.0006102  1.0006610
#&gt; 9  1.0006121  1.0006121</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Gopal Penny.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


