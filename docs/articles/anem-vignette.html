<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>anem-vignette • anem</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="anem-vignette">
<meta property="og:description" content="anem">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">anem</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/anem-vignette.html">anem-vignette</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>anem-vignette</h1>
                        <h4 class="author">Gopal Penny</h4>
            
            <h4 class="date">2020-04-17</h4>
      
      
      <div class="hidden name"><code>anem-vignette.Rmd</code></div>

    </div>

    
    
<p>This package was created to evaluate the hydraulic relationships among wells, in order to estimate the effect of a group of wells on drawdown at these wells or other wells. It it based on method of images from the analytical element modeling approach, in which the 2-dimensional characteristics of aquifers are reproduced by strategically placing wells within the domain.</p>
<p>This package models <em>simple</em> aquifer and well configurations. The boundaries of the aquifer can be specified as <em>no flow</em> or <em>constant head</em> boundaries, and the corners of the aquifer must be right angles. For fully bounded aquifers, this means that the aquifer must be a rectangle. The constant head boundaries take the head of the undisturbed aquifer, h0.</p>
<p>Units are designed for length dimensions given in meters (or m<sup>2</sup>), and time in seconds.</p>
<p>As you will see in this vignette, the package has a number of functions that are used to set up the aquifer boundaries and wells. For practical purposes, the package was designed for simple but real aquifers, and wells and boundaries of the aquifers can be imported as shapefiles and then prepared.</p>
<div id="understanding-the-method-of-images" class="section level3">
<h3 class="hasAnchor">
<a href="#understanding-the-method-of-images" class="anchor"></a>Understanding the method of images</h3>
<p>The package relies on the principle of superposition and the method of images to generate groundwater hydrodynamics, illustrated by the two figures below (see <code>?</code> and <code>?</code>, respectively, which give examples for generating similar plots). The principle of super position states that, because the groundwater equations are linear, the solution to the equations can be calculated as the sum of solutions. In the example below, the drawdown of the water table is calculated as the sum of drawdown due to three individual wells.</p>
<p><img src="anem-vignette_files/figure-html/unnamed-chunk-2-1.png" width="528"></p>
<p>In the method of images, wells are mirrored across aquifer boundaries to reproduce characterics of the boundary, such as no flow or constant head. The following examples demonstrate (a) how a no-flow boundary is created by mirroring a well across the boundary, and (b) how a constant head boundary is recreated by mirroring the well and inverting the pumping.</p>
<p><img src="anem-vignette_files/figure-html/unnamed-chunk-3-1.png" width="528"></p>
</div>
<div id="a-simple-example-of-drawdown-relationships" class="section level2">
<h2 class="hasAnchor">
<a href="#a-simple-example-of-drawdown-relationships" class="anchor"></a>A simple example of drawdown relationships</h2>
<p>Load packages for the vignette</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">sf</span>)
<span class="co"># devtools::install_github("https://github.com/gopalpenny/anem")</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">anem</span>)</pre></body></html></div>
<p>Aquifers in this package are characterized by:</p>
<ul>
<li>Aquifer type, confined or unconfined</li>
<li>Saturated hydraulic conductivity, Ksat</li>
<li>Resting hydraulic head, h0</li>
<li>Thickness of the aquifer, z0 (confined aquifers only)</li>
<li>Porosity of the aquifer, n</li>
<li>Aquifer boundaries, characterized by:
<ul>
<li>Boundary ID, or bID</li>
<li>Coordinates in a cartesian plane, given as slope, m, and intercept, b, and coordinates (x1, y1, x2, y2)</li>
<li>Boundary type, NF, CH, or PB</li>
</ul>
</li>
<li>Additional user-defined parameters</li>
</ul>
<p>Use the <code><a href="../reference/define_aquifer.html">define_aquifer()</a></code> function to create a new aquifer, which has the class <code>aquifer</code>. This class is essentially a list with names parameters and a separate print method.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="co"># define aquifer</span>
<span class="no">bounds_df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">bound_type</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"CH"</span>,<span class="st">"NF"</span>,<span class="st">"NF"</span>,<span class="st">"NF"</span>),<span class="kw">m</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">Inf</span>,<span class="fl">0</span>,<span class="fl">Inf</span>,<span class="fl">0</span>),<span class="kw">b</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">1000</span>,<span class="fl">1000</span>,<span class="fl">0</span>))
<span class="no">aquifer_unconfined</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/define_aquifer.html">define_aquifer</a></span>(<span class="st">"unconfined"</span>,<span class="fl">1e-3</span>,<span class="kw">bounds</span><span class="kw">=</span><span class="no">bounds_df</span>,<span class="kw">h0</span><span class="kw">=</span><span class="fl">100</span>,<span class="kw">n</span><span class="kw">=</span><span class="fl">0.35</span>)
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">aquifer_unconfined</span>)
<span class="co">#&gt; # aquifer_type: unconfined</span>
<span class="co">#&gt; # Ksat: 0.001</span>
<span class="co">#&gt; # h0: 100</span>
<span class="co">#&gt; # n: 0.35</span>
<span class="co">#&gt; # bounds: </span>
<span class="co">#&gt; # A tibble: 4 x 8</span>
<span class="co">#&gt;     bID bound_type     m     b    x1    y1    x2    y2</span>
<span class="co">#&gt;   &lt;int&gt; &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1     1 CH           Inf     0     0  1000     0     0</span>
<span class="co">#&gt; 2     2 NF             0  1000     0  1000  1000  1000</span>
<span class="co">#&gt; 3     3 NF           Inf  1000  1000  1000  1000     0</span>
<span class="co">#&gt; 4     4 NF             0     0     0     0  1000     0</span>
<span class="co">#&gt; # recharge (undisturbed water table): </span>
<span class="co">#&gt;     No recharge zones</span></pre></body></html></div>
<p>Wells are characterized by:</p>
<ul>
<li>Well ID, or wID</li>
<li>Location x, y</li>
<li>Pumping rate (+ for injection, - for pumping), Q</li>
<li>Radius of influence, R</li>
<li>Diameter, diam</li>
<li>Well images (which are noted in the <code>well_image</code> column)</li>
<li>Additional user-defined columns, including groups or weights.</li>
</ul>
<p>The code below Defines 8 pumping wells using random locations and arbitrarily divides wells into countries “A” and “B” using a threshold at y = 500 m. The <code><a href="../reference/define_wells.html">define_wells()</a></code> function ensures that the wells have all appropriate columns, and the class of the returned object is a <code>tibble</code> (which functions like a <code>data.frame</code>, but has a couple bells and whistles). Also note that the radius of influence (R) is defined arbitrarily, but there is also a function to calculate this manually – see <code><a href="../reference/get_ROI.html">?get_ROI</a></code> for more details.</p>
<p>The <code><a href="../reference/generate_image_wells.html">generate_image_wells()</a></code> function generates well images to recreate the bounderies defined by the aquifer, <code>aquifer_unconfined</code>.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="co"># define wells and well images</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">15</span>)
<span class="no">wells_actual</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/define_wells.html">define_wells</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="fl">8</span>,<span class="fl">0</span>,<span class="fl">1000</span>),
                             <span class="kw">y</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="fl">4</span>,<span class="fl">0</span>,<span class="fl">500</span>),<span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="fl">4</span>,<span class="fl">500</span>,<span class="fl">1000</span>)),
                             <span class="kw">Q</span> <span class="kw">=</span> -<span class="fl">1</span>/<span class="fl">4</span>,
                             <span class="kw">diam</span> <span class="kw">=</span> <span class="fl">1</span>,
                             <span class="kw">R</span> <span class="kw">=</span> <span class="fl">1000</span>,
                             <span class="kw">weights</span> <span class="kw">=</span> <span class="fl">1</span>,
                             <span class="kw">country</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"A"</span>,<span class="st">"B"</span>),<span class="kw">each</span><span class="kw">=</span><span class="fl">4</span>))
<span class="no">wells</span> <span class="kw">&lt;-</span> <span class="no">wells_actual</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/generate_image_wells.html">generate_image_wells</a></span>(<span class="no">aquifer_unconfined</span>)
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">wells</span>)
<span class="co">#&gt; # A tibble: 68 x 11</span>
<span class="co">#&gt;      wID     Q     R  diam     x      y well_type well_image weights</span>
<span class="co">#&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;fct&gt;     &lt;chr&gt;        &lt;dbl&gt;</span>
<span class="co">#&gt;  1     1 -0.25  1000     1  602.  344.  Pumping   Actual           1</span>
<span class="co">#&gt;  2     2 -0.25  1000     1  195.  416.  Pumping   Actual           1</span>
<span class="co">#&gt;  3     3 -0.25  1000     1  966.   52.3 Pumping   Actual           1</span>
<span class="co">#&gt;  4     4 -0.25  1000     1  651.  323.  Pumping   Actual           1</span>
<span class="co">#&gt;  5     5 -0.25  1000     1  367.  755.  Pumping   Actual           1</span>
<span class="co">#&gt;  6     6 -0.25  1000     1  989.  853.  Pumping   Actual           1</span>
<span class="co">#&gt;  7     7 -0.25  1000     1  815.  931.  Pumping   Actual           1</span>
<span class="co">#&gt;  8     8 -0.25  1000     1  254.  921.  Pumping   Actual           1</span>
<span class="co">#&gt;  9     9 -0.25  1000     1  602. 1656.  Pumping   Image (+Q)       1</span>
<span class="co">#&gt; 10    10 -0.25  1000     1  602. -344.  Pumping   Image (+Q)       1</span>
<span class="co">#&gt; # … with 58 more rows, and 2 more variables: country &lt;chr&gt;, orig_wID &lt;int&gt;</span></pre></body></html></div>
<p>Plot the aquifer and wells.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>() +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span>(<span class="kw">data</span><span class="kw">=</span><span class="no">aquifer_unconfined</span>$<span class="no">bounds</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">x1</span>,<span class="no">y1</span>,<span class="kw">xend</span><span class="kw">=</span><span class="no">x2</span>,<span class="kw">yend</span><span class="kw">=</span><span class="no">y2</span>,<span class="kw">linetype</span><span class="kw">=</span><span class="no">bound_type</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span>(<span class="kw">slope</span><span class="kw">=</span><span class="fl">0</span>,<span class="kw">intercept</span><span class="kw">=</span><span class="fl">500</span>,<span class="kw">linetype</span><span class="kw">=</span><span class="st">"dashed"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw">data</span><span class="kw">=</span><span class="no">wells_actual</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">x</span>,<span class="no">y</span>,<span class="kw">fill</span><span class="kw">=</span><span class="no">country</span>),<span class="kw">shape</span><span class="kw">=</span><span class="fl">21</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_equal</a></span>()</pre></body></html></div>
<p><img src="anem-vignette_files/figure-html/set_simple_wells-1.png" width="384"></p>
<p>Get drawdown relationships using <code><a href="../reference/get_drawdown_relationships.html">get_drawdown_relationships()</a></code>. This function calculates the average drawdown at wells in each group defined by the column <code>group_column</code>. The average is taken as the weighted mean, determined by the <code>weights_column</code>. The weights were previously set equal for all wells so that the result here is a simple mean. The results show PHIii and PHIij.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">drawdown_relationships</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_drawdown_relationships.html">get_drawdown_relationships</a></span>(<span class="no">wells</span>, <span class="no">aquifer_unconfined</span>, <span class="kw">group_column</span><span class="kw">=</span><span class="no">country</span>, <span class="kw">weights_column</span><span class="kw">=</span><span class="no">weights</span>)
<span class="no">drawdown_relationships</span></pre></body></html></div>
<table class="table">
<thead><tr>
<th style="text-align:left;">
var
</th>
<th style="text-align:right;">
pot
</th>
<th style="text-align:left;">
units
</th>
<th style="text-align:left;">
description
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
PHI_A_A
</td>
<td style="text-align:right;">
1199.6188
</td>
<td style="text-align:left;">
[m^2/cumec]
</td>
<td style="text-align:left;">
Weighted effect of pumping [cumec] in group A on discharge potential [m^2] in group A
</td>
</tr>
<tr>
<td style="text-align:left;">
PHI_A_B
</td>
<td style="text-align:right;">
189.2822
</td>
<td style="text-align:left;">
[m^2/cumec]
</td>
<td style="text-align:left;">
Weighted effect of pumping [cumec] in group B on discharge potential [m^2] in group A
</td>
</tr>
<tr>
<td style="text-align:left;">
PHI_B_A
</td>
<td style="text-align:right;">
189.2822
</td>
<td style="text-align:left;">
[m^2/cumec]
</td>
<td style="text-align:left;">
Weighted effect of pumping [cumec] in group A on discharge potential [m^2] in group B
</td>
</tr>
<tr>
<td style="text-align:left;">
PHI_B_B
</td>
<td style="text-align:right;">
1342.9247
</td>
<td style="text-align:left;">
[m^2/cumec]
</td>
<td style="text-align:left;">
Weighted effect of pumping [cumec] in group B on discharge potential [m^2] in group B
</td>
</tr>
</tbody>
</table>
<div id="plot-the-head-and-flow" class="section level3">
<h3 class="hasAnchor">
<a href="#plot-the-head-and-flow" class="anchor"></a>Plot the head and flow</h3>
<p>The hydrodynamics of the aquifer can be mapped by obtaining gridded heand flow using the <code><a href="../reference/get_gridded_hydrodynamics.html">get_gridded_hydrodynamics()</a></code> function. The function takes as input the wells, aquifer, and grid dimensions for head and flow. It returns a <code>list</code> object with data.frames for head and flow, which can then be plotted.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">gridded_1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_gridded_hydrodynamics.html">get_gridded_hydrodynamics</a></span>(<span class="no">wells</span>,<span class="no">aquifer_unconfined</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">20</span>,<span class="fl">20</span>),<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">8</span>,<span class="fl">8</span>))

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>() +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_raster</a></span>(<span class="kw">data</span><span class="kw">=</span><span class="no">gridded_1</span>$<span class="no">head</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">x</span>,<span class="no">y</span>,<span class="kw">fill</span><span class="kw">=</span><span class="no">head_m</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_contour.html">geom_contour</a></span>(<span class="kw">data</span><span class="kw">=</span><span class="no">gridded_1</span>$<span class="no">head</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">x</span>,<span class="no">y</span>,<span class="kw">z</span><span class="kw">=</span><span class="no">head_m</span>),<span class="kw">color</span><span class="kw">=</span><span class="st">"white"</span>,<span class="kw">alpha</span><span class="kw">=</span><span class="fl">0.3</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span>(<span class="kw">data</span><span class="kw">=</span><span class="no">gridded_1</span>$<span class="no">flow</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">x</span>,<span class="no">y</span>,<span class="kw">xend</span><span class="kw">=</span><span class="no">x2</span>,<span class="kw">yend</span><span class="kw">=</span><span class="no">y2</span>),
               <span class="kw">arrow</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/reexports.html">arrow</a></span>(<span class="kw">ends</span><span class="kw">=</span><span class="st">"last"</span>,<span class="kw">type</span><span class="kw">=</span><span class="st">"closed"</span>,<span class="kw">length</span><span class="kw">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/reexports.html">unit</a></span>(<span class="fl">1</span>,<span class="st">"mm"</span>)),<span class="kw">color</span><span class="kw">=</span><span class="st">"black"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span>(<span class="kw">data</span><span class="kw">=</span><span class="no">aquifer_unconfined</span>$<span class="no">bounds</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">x1</span>,<span class="no">y1</span>,<span class="kw">xend</span><span class="kw">=</span><span class="no">x2</span>,<span class="kw">yend</span><span class="kw">=</span><span class="no">y2</span>,<span class="kw">linetype</span><span class="kw">=</span><span class="no">bound_type</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw">data</span><span class="kw">=</span><span class="no">wells</span> <span class="kw">%&gt;%</span> <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">wID</span><span class="kw">==</span><span class="no">orig_wID</span>),<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">x</span>,<span class="no">y</span>),<span class="kw">shape</span><span class="kw">=</span><span class="fl">21</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_equal</a></span>()
<span class="co">#&gt; Warning: Removed 2 rows containing missing values (geom_segment).</span></pre></body></html></div>
<p><img src="anem-vignette_files/figure-html/unnamed-chunk-5-1.png" width="384"></p>
</div>
<div id="check-the-head-and-flow-along-the-boundaries" class="section level3">
<h3 class="hasAnchor">
<a href="#check-the-head-and-flow-along-the-boundaries" class="anchor"></a>Check the head and flow along the boundaries</h3>
<p>The function <code><a href="../reference/get_bounds_behavior.html">get_bounds_behavior()</a></code> is a helper function to generate hydraulic properties at the boundaries. It obtains hydraulic head and the flow normal to the boundaries by setting boundaries to segments and using <code><a href="../reference/get_segments_behavior.html">get_segments_behavior()</a></code>. Normal flow is defined such that positive flow has some component in the x-direction (the y-direction depends on the normal vector for the boundary). The function <code><a href="../reference/plot_bounds_behavior.html">plot_bounds_behavior()</a></code> is a wrapper around <code><a href="../reference/get_bounds_behavior.html">get_bounds_behavior()</a></code>, and it can be used to quickly compare the hydraulic head along the boundaries and flow across the boundaries under two scenarios:</p>
<ul>
<li>no images (ie, homogeneous, uniform aquifer – all well images removed)</li>
<li>images (ie, aquifer with boundaries – all well images intact)</li>
</ul>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">bounds_behavior</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/plot_bounds_behavior.html">plot_bounds_behavior</a></span>(<span class="no">wells</span>,<span class="no">aquifer_unconfined</span>)
<span class="kw pkg">gridExtra</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span>(<span class="no">bounds_behavior</span>$<span class="no">p_h</span>,<span class="no">bounds_behavior</span>$<span class="no">p_f</span>,<span class="kw">nrow</span><span class="kw">=</span><span class="fl">1</span>)</pre></body></html></div>
<p><img src="anem-vignette_files/figure-html/check_bounds-1.png" width="576"></p>
<p>Finally, the function <code>plot_bounds_behavior</code> also includes the raw data of head and flow used to create the above plots (<code>bounds_behavior$bounds_behavior</code>), as well as a summary of these values which includes mean head on each of the boundaries and mean flow as the mean of the absolute value of flow normal to each boundary (<code>bounds_behavior$table</code>). To numerically check that the boundaries are working as expected, we can print <code>bounds_behavior$table</code>:</p>
<table class="table">
<thead><tr>
<th style="text-align:left;">
bound
</th>
<th style="text-align:right;">
Mean flow, images
</th>
<th style="text-align:right;">
Mean flow, no images
</th>
<th style="text-align:right;">
Mean head, images
</th>
<th style="text-align:right;">
Mean head, no images
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
1 CH
</td>
<td style="text-align:right;">
1.07e-05
</td>
<td style="text-align:right;">
3.9e-06
</td>
<td style="text-align:right;">
100.00000
</td>
<td style="text-align:right;">
98.64171
</td>
</tr>
<tr>
<td style="text-align:left;">
2 NF
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:right;">
5.4e-06
</td>
<td style="text-align:right;">
95.01699
</td>
<td style="text-align:right;">
97.82476
</td>
</tr>
<tr>
<td style="text-align:left;">
3 NF
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:right;">
5.7e-06
</td>
<td style="text-align:right;">
93.32580
</td>
<td style="text-align:right;">
97.81516
</td>
</tr>
<tr>
<td style="text-align:left;">
4 NF
</td>
<td style="text-align:right;">
0.00e+00
</td>
<td style="text-align:right;">
4.2e-06
</td>
<td style="text-align:right;">
96.37611
</td>
<td style="text-align:right;">
98.55836
</td>
</tr>
</tbody>
</table>
</div>
<div id="defining-recharge-background-flow" class="section level3">
<h3 class="hasAnchor">
<a href="#defining-recharge-background-flow" class="anchor"></a>Defining recharge / background flow</h3>
<p>Background flow is parameterized by defining “recharge” in the aquifer. Recharge can be defined as a constant flow (F) or a recharge divide (D). In both cases, flow is defined as m<sup>3</sup> / m-s, in the direction of the recharge vector. Recharge is therefore defined by specifying:</p>
<ul>
<li>Type of recharge: constant flow (F) or recharge divide (D)</li>
<li>Recharge vector, pointing in the direction of flow</li>
<li>Flow magnitude, in units of m<sup>3</sup> / m-s</li>
<li>Coordinates where the undisturbed water table (no wells) has a hydraulic head equal to aquifer$h0.</li>
</ul>
<p>See <code><a href="../reference/define_recharge.html">?define_recharge</a></code> for more details.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="co"># Define recharge for type "D"</span>
<span class="no">recharge_params</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">recharge_type</span><span class="kw">=</span><span class="st">"D"</span>,<span class="kw">recharge_vector</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">500</span>,<span class="fl">500</span>,<span class="fl">501</span>,<span class="fl">501</span>),
                        <span class="kw">flow_main</span><span class="kw">=</span><span class="fl">1e-3</span>,<span class="kw">flow_opp</span><span class="kw">=</span><span class="fl">2e-3</span>,<span class="kw">x0</span><span class="kw">=</span><span class="fl">0</span>,<span class="kw">y0</span><span class="kw">=</span><span class="fl">0</span>)

<span class="co"># Define bounds as "PB" -- pervious bounds, which have no effect (other than to define output grid)</span>
<span class="no">bounds_recharge</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/define_bounds.html">define_bounds</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">bound_type</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"PB"</span>,<span class="fl">4</span>),<span class="kw">m</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">Inf</span>,<span class="fl">0</span>,<span class="fl">Inf</span>,<span class="fl">0</span>),<span class="kw">b</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1000</span>,<span class="fl">1000</span>)))
<span class="no">aquifer_recharge</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/define_aquifer.html">define_aquifer</a></span>(<span class="st">"confined"</span>,<span class="fl">1</span>,<span class="kw">h0</span><span class="kw">=</span><span class="fl">0</span>,<span class="kw">z0</span><span class="kw">=</span><span class="fl">1</span>,<span class="kw">n</span><span class="kw">=</span><span class="fl">0.35</span>,<span class="kw">recharge</span><span class="kw">=</span><span class="no">recharge_params</span>,<span class="kw">bounds</span><span class="kw">=</span><span class="no">bounds_recharge</span>)
<span class="no">gridded_2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_gridded_hydrodynamics.html">get_gridded_hydrodynamics</a></span>(<span class="no">wells_actual</span>,<span class="no">aquifer_recharge</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">20</span>,<span class="fl">20</span>),<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">8</span>,<span class="fl">8</span>))</pre></body></html></div>
<p>The results can then be plotted, just as above:</p>
<p><img src="anem-vignette_files/figure-html/unnamed-chunk-8-1.png" width="384"></p>
</div>
<div id="particle-tracking" class="section level3">
<h3 class="hasAnchor">
<a href="#particle-tracking" class="anchor"></a>Particle tracking</h3>
<p>The package implements particle tracking in two ways: (1) tracking individual particles using <code>track_particles</code> and (2) estimating capture zones of wells using <code>get_capture_zone</code>, which initializes particles in the vicinity of wells and tracks them in reverse. Here we use <code>get_capture_zone</code> on the previous aquifer to generate particle tracking away from wells.</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="co"># wells &lt;- wells</span>
<span class="co"># wells[4,"Q"] &lt;- 0.25</span>
<span class="no">well_particles</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_capture_zone.html">get_capture_zone</a></span>(<span class="no">wells</span>,<span class="no">aquifer_unconfined</span>,<span class="kw">t_max</span><span class="kw">=</span><span class="fl">365</span>,<span class="kw">n_particles</span><span class="kw">=</span><span class="fl">4</span>)</pre></body></html></div>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="no">gridded_3</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_gridded_hydrodynamics.html">get_gridded_hydrodynamics</a></span>(<span class="no">wells</span>,<span class="no">aquifer_unconfined</span>)
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>() +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_raster</a></span>(<span class="kw">data</span><span class="kw">=</span><span class="no">gridded_1</span>$<span class="no">head</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">x</span>,<span class="no">y</span>,<span class="kw">fill</span><span class="kw">=</span><span class="no">head_m</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_contour.html">geom_contour</a></span>(<span class="kw">data</span><span class="kw">=</span><span class="no">gridded_1</span>$<span class="no">head</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">x</span>,<span class="no">y</span>,<span class="kw">z</span><span class="kw">=</span><span class="no">head_m</span>),<span class="kw">color</span><span class="kw">=</span><span class="st">"white"</span>,<span class="kw">alpha</span><span class="kw">=</span><span class="fl">0.3</span>) +
  <span class="co"># geom_segment(data=gridded_1$flow,aes(x,y,xend=x2,yend=y2),</span>
  <span class="co">#              arrow = arrow(ends="last",type="closed",length=unit(1,"mm")),color="black") +</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span>(<span class="kw">data</span><span class="kw">=</span><span class="no">aquifer_unconfined</span>$<span class="no">bounds</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">x1</span>,<span class="no">y1</span>,<span class="kw">xend</span><span class="kw">=</span><span class="no">x2</span>,<span class="kw">yend</span><span class="kw">=</span><span class="no">y2</span>,<span class="kw">linetype</span><span class="kw">=</span><span class="no">bound_type</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_path</a></span>(<span class="kw">data</span><span class="kw">=</span><span class="no">well_particles</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">x</span>,<span class="no">y</span>,<span class="kw">group</span><span class="kw">=</span><span class="no">i</span>,<span class="kw">color</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">wID</span>)),<span class="kw">show.legend</span> <span class="kw">=</span> <span class="fl">FALSE</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw">data</span><span class="kw">=</span><span class="no">wells_actual</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">x</span>,<span class="no">y</span>,<span class="kw">color</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">wID</span>)),<span class="kw">shape</span><span class="kw">=</span><span class="fl">21</span>,<span class="kw">show.legend</span> <span class="kw">=</span> <span class="fl">FALSE</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_equal</a></span>()</pre></body></html></div>
<p><img src="anem-vignette_files/figure-html/unnamed-chunk-10-1.png" width="384"></p>
</div>
<div id="integrating-with-anem-app" class="section level3">
<h3 class="hasAnchor">
<a href="#integrating-with-anem-app" class="anchor"></a>Integrating with anem-app</h3>
<p>The basic functionality of this package is implemented online in a Shiny application, <a href="https://gopalpenny.shinyapps.io/anem-app/">anem-app</a>. The Shiny application provides an GUI for setting aquifer properties, drawing boundaries, defining recharge, adding wells, and tracking particles. It also displays results directly in the app. You can also download scenarios created on anem-app and import them into R. To do so, check out <code><a href="../reference/import_app_rds.html">?import_app_rds</a></code> from this package to learn more.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Gopal Penny.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
