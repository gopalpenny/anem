y_well <- wells$y
R <- wells$R
Q <- wells$Q
diam_wells <- wells$diam
if (max(grepl("data.frame",class(loc)))) {
x_loc <- loc$x
y_loc <- loc$y
} else {
x_loc <- loc[1]
y_loc <- loc[2]
}
ni <- length(x_well) # number of wells
mj <- length(x_loc) # number of locations to measure potential
# create mj x ni matrices -- rows j vary for locations, columns i for wells
xi <- matrix(rep(x_well,each=mj,nrow=ni), ncol=ni) # mj x ni matrix
yi <- matrix(rep(y_well,each=mj,nrow=ni), ncol=ni) # mj x ni matrix
xj <- matrix(rep(x_loc,ni,nrow=ni), ncol=ni)
yj <- matrix(rep(y_loc,ni,nrow=ni), ncol=ni)
Qi <- matrix(rep(Q,each=mj),ncol=ni)
theta_i=atan((yj-yi)/(xj-xi))+(xj<xi)*sign((yj>=yi)-0.5)*pi
di <- matrix(rep(diam_wells,each=mj),ncol=ni)
# Check to make sure r < R (none of the wells reaches it's full extent)
Ri <- matrix(rep(R,each=mj),ncol=ni)
rji <- sqrt((xi-xj)^2 + (yi-yj)^2)
max(rji > Ri)
if (max(rji > Ri)) {
warning("get_stream_function does not account for radius of influence.")
}
rm(list=ls())
devtools::load_all(".")
wells_constant_head <- define_wells(x=c(-100,100),y=c(-0,0),Q=c(1e-2,-1e-2),diam=c(0.1,0.1),R=c(200,200))
loc <- crossing(x=seq(-200,200,length.out=200),y=seq(-200,200,length.out=200))
aquifer <- define_aquifer("confined",1e-4,z0=20,h0=0)
constant_head_boundary <- loc %>%
dplyr::bind_cols(streamfunction=get_stream_function(loc,wells_constant_head,aquifer)) %>%
dplyr::bind_cols(head=get_hydraulic_head(loc,wells_constant_head,aquifer))
wells_constant_head <- define_wells(x=c(-100,100),y=c(-0,0),Q=c(1e-2,-1e-2),diam=c(0.1,0.1),R=c(500,500))
loc <- crossing(x=seq(-200,200,length.out=200),y=seq(-200,200,length.out=200))
aquifer <- define_aquifer("confined",1e-4,z0=20,h0=0)
constant_head_boundary <- loc %>%
dplyr::bind_cols(streamfunction=get_stream_function(loc,wells_constant_head,aquifer)) %>%
dplyr::bind_cols(head=get_hydraulic_head(loc,wells_constant_head,aquifer))
ggplot() +
geom_contour(data=constant_head_boundary,aes(x,y,z=head),bins=20,linetype="dashed") +
geom_contour(data=constant_head_boundary,aes(x,y,z=streamfunction),bins=20) +
geom_point(data=wells_constant_head,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal()
wells_no_flow <- define_wells(x=c(-100,100),y=c(-0,0),Q=c(-1e-2,-1e-2),diam=c(0.1,0.1),R=c(500,500))
no_flow_boundary <- loc %>%
dplyr::bind_cols(streamfunction=get_stream_function(loc,wells_no_flow,aquifer)) %>%
dplyr::bind_cols(head=get_hydraulic_head(loc,wells_no_flow,aquifer))
wells_no_flow <- define_wells(x=c(-100,100),y=c(-0,0),Q=c(-1e-2,-1e-2),diam=c(0.1,0.1),R=c(200,500))
no_flow_boundary <- loc %>%
dplyr::bind_cols(streamfunction=get_stream_function(loc,wells_no_flow,aquifer)) %>%
dplyr::bind_cols(head=get_hydraulic_head(loc,wells_no_flow,aquifer))
ggplot() +
wells_no_flow <- define_wells(x=c(-100,100),y=c(-0,0),Q=c(-1e-2,-1e-2),diam=c(0.1,0.1),R=c(500,500))
no_flow_boundary <- loc %>%
dplyr::bind_cols(streamfunction=get_stream_function(loc,wells_no_flow,aquifer)) %>%
dplyr::bind_cols(head=get_hydraulic_head(loc,wells_no_flow,aquifer))
ggplot() +
geom_contour(data=no_flow_boundary,aes(x,y,z=head),bins=20,linetype="dashed") +
geom_contour(data=no_flow_boundary,aes(x,y,z=streamfunction),bins=50) +
geom_point(data=wells_no_flow,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal()
wells_no_flow <- define_wells(x=c(-100,100),y=c(-0,0),Q=c(-1e-2,-1e-2),diam=c(0.1,0.1),R=c(500,500))
no_flow_boundary <- loc %>%
dplyr::bind_cols(streamfunction=get_stream_function(loc,wells_no_flow,aquifer)) %>%
dplyr::bind_cols(head=get_hydraulic_head(loc,wells_no_flow,aquifer))
ggplot() +
geom_contour(data=no_flow_boundary,aes(x,y,z=head),bins=20,linetype="dashed") +
geom_contour(data=no_flow_boundary,aes(x,y,z=streamfunction),bins=50) +
geom_point(data=wells_no_flow,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal()
ggplot() +
geom_raster(data=no_flow_boundary,aes(x,y,fill=streamfunction)) +
geom_contour(data=no_flow_boundary,aes(x,y,z=head),bins=20,linetype="dashed") +
geom_point(data=wells_no_flow,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal()
ggplot() +
geom_raster(data=no_flow_boundary,aes(x,y,fill=streamfunction)) +
geom_contour(data=no_flow_boundary,aes(x,y,z=head),bins=20,linetype="dashed") +
geom_point(data=wells_no_flow,aes(x,y,color=well_type),size=3,shape=1) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal()
no_flow_boundary %>% filter(x==0)
no_flow_boundary
no_flow_boundary %>% filter(x==0)
no_flow_boundary
no_flow_boundary %>% table(x)
no_flow_boundary %>% filter(x==200)
wells_constant_head <- define_wells(x=c(-100,100),y=c(-0,0),Q=c(1e-2,-1e-2),diam=c(0.1,0.1),R=c(500,500))
loc <- crossing(x=seq(-200,200,length.out=400),y=seq(-200,200,length.out=400))
aquifer <- define_aquifer("confined",1e-4,z0=20,h0=0)
constant_head_boundary <- loc %>%
dplyr::bind_cols(streamfunction=get_stream_function(loc,wells_constant_head,aquifer)) %>%
dplyr::bind_cols(head=get_hydraulic_head(loc,wells_constant_head,aquifer))
ggplot() +
geom_contour(data=constant_head_boundary,aes(x,y,z=head),bins=20,linetype="dashed") +
geom_contour(data=constant_head_boundary,aes(x,y,z=streamfunction),bins=20) +
geom_point(data=wells_constant_head,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal()
wells_constant_head <- define_wells(x=c(-100,100),y=c(-0,0),Q=c(1e-2,-1e-2),diam=c(0.1,0.1),R=c(500,500))
loc <- crossing(x=seq(-200,200,length.out=200),y=seq(-200,200,length.out=200))
aquifer <- define_aquifer("confined",1e-4,z0=20,h0=0)
constant_head_boundary <- loc %>%
dplyr::bind_cols(streamfunction=get_stream_function(loc,wells_constant_head,aquifer)) %>%
dplyr::bind_cols(head=get_hydraulic_head(loc,wells_constant_head,aquifer))
ggplot() +
geom_contour(data=constant_head_boundary,aes(x,y,z=head),bins=20,linetype="dashed") +
geom_contour(data=constant_head_boundary,aes(x,y,z=streamfunction),bins=20) +
geom_point(data=wells_constant_head,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal()
wells_no_flow <- define_wells(x=c(-100,100),y=c(-0,0),Q=c(-1e-2,-1e-2),diam=c(0.1,0.1),R=c(500,500))
no_flow_boundary <- loc %>%
dplyr::bind_cols(streamfunction=get_stream_function(loc,wells_no_flow,aquifer)) %>%
dplyr::bind_cols(head=get_hydraulic_head(loc,wells_no_flow,aquifer))
loc %>% filter(x==0)
loc %>% filter(abs(x)<10)
loc <- crossing(x=seq(-200,200,length.out=200),y=seq(-200,200,length.out=200))
loc %>% filter(abs(x)<10)
length(seq(-200,200,length.out=200))
seq(-200,200,length.out=200)[1]
seq(-200,200,length.out=200)[100]
seq(-200,200,length.out=200)[3]
seq(-200,200,length.out=200)[200]
?seq
loc <- crossing(x=seq(-200,200,length.out=201),y=seq(-200,201,length.out=200))
loc %>% filter(x==1)
loc %>% filter(x==0)
loc %>% filter(x==2)
loc <- crossing(x=seq(-200,200,length.out=201),y=seq(-200,201,length.out=201))
wells_constant_head <- define_wells(x=c(-100,100),y=c(-0,0),Q=c(1e-2,-1e-2),diam=c(0.1,0.1),R=c(500,500))
aquifer <- define_aquifer("confined",1e-4,z0=20,h0=0)
constant_head_boundary <- loc %>%
dplyr::bind_cols(streamfunction=get_stream_function(loc,wells_constant_head,aquifer)) %>%
dplyr::bind_cols(head=get_hydraulic_head(loc,wells_constant_head,aquifer))
ggplot() +
geom_contour(data=constant_head_boundary,aes(x,y,z=head),bins=20,linetype="dashed") +
geom_contour(data=constant_head_boundary,aes(x,y,z=streamfunction),bins=20) +
geom_point(data=wells_constant_head,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal()
wells_no_flow <- define_wells(x=c(-100,100),y=c(-0,0),Q=c(-1e-2,-1e-2),diam=c(0.1,0.1),R=c(500,500))
no_flow_boundary <- loc %>%
dplyr::bind_cols(streamfunction=get_stream_function(loc,wells_no_flow,aquifer)) %>%
dplyr::bind_cols(head=get_hydraulic_head(loc,wells_no_flow,aquifer))
ggplot() +
geom_contour(data=no_flow_boundary,aes(x,y,z=head),bins=20,linetype="dashed") +
geom_contour(data=no_flow_boundary,aes(x,y,z=streamfunction),bins=50) +
geom_point(data=wells_no_flow,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal()
no_flow_boundary %>% filter(x==0)
no_flow_boundary %>% filter(x==0) %>% pluck("streamfunction")
no_flow_boundary %>% filter(x==0) %>% pluck("streamfunction") %>% table()
no_flow_boundary %>% filter(x==0) %>% pluck("streamfunction") %>% table() %>% length()
no_flow_boundary %>% filter(x==2) %>% pluck("streamfunction") %>% table() %>% length()
no_flow_boundary %>% filter(y==0) %>% pluck("streamfunction") %>% table() %>% length()
no_flow_boundary %>% filter(y==0) %>% pluck("streamfunction")# %>% table() %>% length()
loc <- crossing(x=seq(-200,200,length.out=201),y=seq(-200,200,length.out=201))
wells_constant_head <- define_wells(x=c(-100,100),y=c(-0,0),Q=c(1e-2,-1e-2),diam=c(0.1,0.1),R=c(500,500))
aquifer <- define_aquifer("confined",1e-4,z0=20,h0=0)
constant_head_boundary <- loc %>%
dplyr::bind_cols(streamfunction=get_stream_function(loc,wells_constant_head,aquifer)) %>%
dplyr::bind_cols(head=get_hydraulic_head(loc,wells_constant_head,aquifer))
ggplot() +
geom_contour(data=constant_head_boundary,aes(x,y,z=head),bins=20,linetype="dashed") +
geom_contour(data=constant_head_boundary,aes(x,y,z=streamfunction),bins=20) +
geom_point(data=wells_constant_head,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal()
wells_no_flow <- define_wells(x=c(-100,100),y=c(-0,0),Q=c(-1e-2,-1e-2),diam=c(0.1,0.1),R=c(500,500))
no_flow_boundary <- loc %>%
dplyr::bind_cols(streamfunction=get_stream_function(loc,wells_no_flow,aquifer)) %>%
dplyr::bind_cols(head=get_hydraulic_head(loc,wells_no_flow,aquifer))
no_flow_boundary %>% filter(x==2) %>% pluck("streamfunction") %>% table() %>% length()
no_flow_boundary %>% filter(y==0) %>% pluck("streamfunction")# %>% table() %>% length()
no_flow_boundary %>% filter(x==2) %>% pluck("streamfunction") %>% table() %>% length()
no_flow_boundary %>% filter(x==0) %>% pluck("streamfunction") %>% table() %>% length()
no_flow_boundary %>% filter(y==0) %>% pluck("streamfunction")# %>% table() %>% length()
no_flow_boundary %>% filter(y==0) %>% pluck("streamfunction") %>% table() %>% length()
constant_head_boundary %>% filter(y==0) %>% pluck("streamfunction") %>% table() %>% length()
constant_head_boundary %>% filter(x==0) %>% pluck("streamfunction") %>% table() %>% length()
expect_equal(no_flow_boundary %>% filter(x==0) %>% pluck("streamfunction") %>% table() %>% length(),2)
expect_equal(no_flow_boundary %>% filter(y==0) %>% pluck("streamfunction") %>% table() %>% length(),3)
no_flow_boundary %>% filter(x==0) %>% pluck("streamfunction") %>% table()
constant_head_boundary %>% filter(y==0) %>% pluck("streamfunction") %>% table() %>% length()
expect_equal(constant_head_boundary %>% filter(y==0) %>% pluck("streamfunction") %>% table() %>% length(),2)
expect_equal(constant_head_boundary %>% filter(y==0) %>% pluck("streamfunction") %>% table() %>% length(),2)
constant_head_boundary %>% filter(y==0) %>% pluck("streamfunction") %>% table() %>% length()
constant_head_boundary %>% filter(y==0) %>% pluck("streamfunction") %>% table() %>% length()
?get_stream_function
?get_stream_function
?get_stream_function
?get_stream_function
?get_stream_function
?get_stream_function
?get_stream_function
?unlist
devtools::load_all(".")
dplyr::crossing
tidyr::crossing
rm(list=ls())
# Create a grid of locations and define aquifer
loc <- tidyr::crossing(x=seq(-200,200,length.out=201),y=seq(-200,200,length.out=201))
aquifer <- define_aquifer("confined",1e-4,z0=20,h0=0)
# No flow boundary
wells_no_flow <- define_wells(x=c(-100,100),y=c(-0,0),Q=c(-1e-2,-1e-2),diam=c(0.1,0.1),R=c(500,500))
no_flow_boundary <- loc %>%
dplyr::bind_cols(streamfunction=get_stream_function(loc,wells_no_flow,aquifer)) %>%
dplyr::bind_cols(head=get_hydraulic_head(loc,wells_no_flow,aquifer))
expect_equal(no_flow_boundary %>% dplyr::filter(x==0) %>% purrr::pluck("streamfunction") %>% table() %>% length(),2)
expect_equal(no_flow_boundary %>% dplyr::filter(y==0) %>% purrr::pluck("streamfunction") %>% table() %>% length(),3)
# Constant head boundary
wells_constant_head <- define_wells(x=c(-100,100),y=c(-0,0),Q=c(1e-2,-1e-2),diam=c(0.1,0.1),R=c(500,500))
aquifer <- define_aquifer("confined",1e-4,z0=20,h0=0)
constant_head_boundary <- loc %>%
dplyr::bind_cols(streamfunction=get_stream_function(loc,wells_constant_head,aquifer))
expect_equal(constant_head_boundary %>% filter(y==0) %>% pluck("streamfunction") %>% table() %>% length(),2)
devtools::load_all(".")
?get_stream_function
library(anem)
library(anem)
library(tidyverse)
library(sf)
library(sf)
# devtools::install_github("https://github.com/gopalpenny/anem")
# devtools::load_all("~/Projects/R_packages/anem")
library(anem)
# Create a grid of locations
loc <- crossing(x=seq(-200,200,length.out=201),y=seq(-200,200,length.out=201))
aquifer <- define_aquifer("confined",1e-4,z0=20,h0=0)
constant_head_boundary <- loc %>%
dplyr::bind_cols(streamfunction=get_stream_function(loc,wells_constant_head,aquifer)) %>%
dplyr::bind_cols(head=get_hydraulic_head(loc,wells_constant_head,aquifer))
ggplot() +
geom_contour(data=constant_head_boundary,aes(x,y,z=head),bins=20,linetype="dashed") +
geom_contour(data=constant_head_boundary,aes(x,y,z=streamfunction),bins=20) +
geom_point(data=wells_constant_head,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal()
thm <- theme(axis.text=element_blank(),axis.title=element_blank(),axis.ticks=element_blank(),
panel.background = element_rect(fill=NA,color="black"))
p_CH <- ggplot() +
geom_contour(data=constant_head_boundary,aes(x,y,z=head),bins=20,linetype="dashed") +
geom_contour(data=constant_head_boundary,aes(x,y,z=streamfunction),bins=20) +
geom_point(data=wells_constant_head,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal()
p_NF <- ggplot() +
geom_contour(data=no_flow_boundary,aes(x,y,z=head),bins=20,linetype="dashed") +
geom_contour(data=no_flow_boundary,aes(x,y,z=streamfunction),bins=50) +
geom_point(data=wells_no_flow,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal()
p_NF <- ggplot() +
geom_contour(data=no_flow_boundary,aes(x,y,z=head),bins=20,linetype="dashed") +
geom_contour(data=no_flow_boundary,aes(x,y,z=streamfunction),bins=50) +
geom_point(data=wells_no_flow,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal() + thm
p_NF
p_CH <- ggplot() +
geom_contour(data=constant_head_boundary,aes(x,y,z=head),bins=20,linetype="dashed",color="black") +
geom_contour(data=constant_head_boundary,aes(x,y,z=streamfunction),bins=20,color="black") +
geom_point(data=wells_constant_head,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal() + thm
p_NF <- ggplot() +
geom_contour(data=no_flow_boundary,aes(x,y,z=head),bins=20,linetype="dashed",color="black") +
geom_contour(data=no_flow_boundary,aes(x,y,z=streamfunction),bins=50,color="black") +
geom_point(data=wells_no_flow,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal() + thm
p_NF
p_NF <- ggplot() +
geom_contour(data=no_flow_boundary,aes(x,y,z=head),bins=20,linetype="dashed",color="darkgray") +
geom_contour(data=no_flow_boundary,aes(x,y,z=streamfunction),bins=50,color="darkgray") +
geom_point(data=wells_no_flow,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal() + thm
p_NF
p_NF <- ggplot() +
geom_contour(data=no_flow_boundary,aes(x,y,z=head),bins=20,linetype="dashed",color="black") +
geom_contour(data=no_flow_boundary,aes(x,y,z=streamfunction),bins=50,color="black") +
geom_point(data=wells_no_flow,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal() + thm
p_NF
grid.arrange(p_CH,p_NF)
p_CH <- ggplot() +
geom_contour(data=constant_head_boundary,aes(x,y,z=head),bins=20,linetype="dashed",color="black") +
geom_contour(data=constant_head_boundary,aes(x,y,z=streamfunction),bins=20,color="black") +
geom_point(data=wells_constant_head,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal() + thm
p_NF <- ggplot() +
geom_contour(data=no_flow_boundary,aes(x,y,z=head),bins=20,linetype="dashed",color="black") +
geom_contour(data=no_flow_boundary,aes(x,y,z=streamfunction),bins=50,color="black") +
geom_point(data=wells_no_flow,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal() + thm
grid.arrange(p_CH,p_NF)
gridExtra::grid.arrange(p_CH,p_NF)
gridExtra::grid.arrange(p_CH,p_NF,nrow=1)
p_CH <- ggplot() +
geom_contour(data=constant_head_boundary,aes(x,y,z=head),bins=20,linetype="dashed",color="black") +
geom_contour(data=constant_head_boundary,aes(x,y,z=streamfunction),bins=20,color="black") +
geom_point(data=wells_constant_head,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal() + thm + ggtitle("Constant head boundary")
p_NF <- ggplot() +
geom_contour(data=no_flow_boundary,aes(x,y,z=head),bins=20,linetype="dashed",color="black") +
geom_contour(data=no_flow_boundary,aes(x,y,z=streamfunction),bins=50,color="black") +
geom_point(data=wells_no_flow,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal() + thm + ggtitle("No flow boundary")
gridExtra::grid.arrange(p_CH,p_NF,nrow=1)
p_CH <- ggplot() +
geom_contour(data=constant_head_boundary,aes(x,y,z=head),bins=20,linetype="dashed",color="black") +
geom_contour(data=constant_head_boundary,aes(x,y,z=streamfunction),bins=20,color="blue") +
geom_point(data=wells_constant_head,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal() + thm + ggtitle("Constant head boundary")
p_NF <- ggplot() +
geom_contour(data=no_flow_boundary,aes(x,y,z=head),bins=20,linetype="dashed",color="black") +
geom_contour(data=no_flow_boundary,aes(x,y,z=streamfunction),bins=50,color="blue") +
geom_point(data=wells_no_flow,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal() + thm + ggtitle("No flow boundary")
gridExtra::grid.arrange(p_CH,p_NF,nrow=1)
p_NF <- ggplot() +
geom_contour(data=no_flow_boundary,aes(x,y,z=head),bins=20,linetype="dashed",color="black") +
geom_contour(data=no_flow_boundary,aes(x,y,z=streamfunction),bins=50,color="darkblue") +
geom_point(data=wells_no_flow,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal() + thm + ggtitle("No flow boundary")
p_NF
p_CH <- ggplot() +
geom_contour(data=constant_head_boundary,aes(x,y,z=head),bins=20,linetype="dashed",color="black") +
geom_contour(data=constant_head_boundary,aes(x,y,z=streamfunction),bins=20,color="blue") +
geom_point(data=wells_constant_head,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal() + thm + ggtitle("Constant head boundary at x = 0")
p_NF <- ggplot() +
geom_contour(data=no_flow_boundary,aes(x,y,z=head),bins=20,linetype="dashed",color="black") +
geom_contour(data=no_flow_boundary,aes(x,y,z=streamfunction),bins=50,color="darkblue") +
geom_point(data=wells_no_flow,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal() + thm + ggtitle("No flow boundary at x = 0")
gridExtra::grid.arrange(p_CH,p_NF,nrow=1)
?theme
thm <- theme(axis.text=element_blank(),axis.title=element_blank(),axis.ticks=element_blank(),
panel.background = element_rect(fill=NA,color="black"),
panel.border = element_rect(fill=NA,color="black"))
p_CH <- ggplot() +
geom_contour(data=constant_head_boundary,aes(x,y,z=head),bins=20,linetype="dashed",color="black") +
geom_contour(data=constant_head_boundary,aes(x,y,z=streamfunction),bins=20,color="blue") +
geom_point(data=wells_constant_head,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal() + thm + ggtitle("Constant head boundary at x = 0")
p_NF <- ggplot() +
geom_contour(data=no_flow_boundary,aes(x,y,z=head),bins=20,linetype="dashed",color="black") +
geom_contour(data=no_flow_boundary,aes(x,y,z=streamfunction),bins=50,color="darkblue") +
geom_point(data=wells_no_flow,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal() + thm + ggtitle("No flow boundary at x = 0")
gridExtra::grid.arrange(p_CH,p_NF,nrow=1)
p_NF <- ggplot() +
geom_contour(data=no_flow_boundary,aes(x,y,z=head),bins=20,linetype="dashed",color="black") +
geom_contour(data=no_flow_boundary,aes(x,y,z=streamfunction),bins=50,color="darkblue") +
geom_point(data=wells_no_flow,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal() + thm + ggtitle("No flow boundary at x = 0")
ggplot() +
geom_contour(data=no_flow_boundary,aes(x,y,z=head),bins=20,linetype="dashed",color="black") +
geom_contour(data=no_flow_boundary,aes(x,y,z=streamfunction),bins=25,color="darkblue") +
geom_point(data=wells_no_flow,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal() + thm + ggtitle("No flow boundary at x = 0")
p_NF <- ggplot() +
geom_contour(data=no_flow_boundary,aes(x,y,z=head),bins=20,linetype="dashed",color="black") +
geom_contour(data=no_flow_boundary,aes(x,y,z=streamfunction),bins=25,color="darkblue") +
geom_point(data=wells_no_flow,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal() + thm + ggtitle("No flow boundary at x = 0")
gridExtra::grid.arrange(p_CH,p_NF,nrow=1)
p_CH <- ggplot() +
geom_contour(data=constant_head_boundary,aes(x,y,z=head),bins=20,linetype="dashed",color="black") +
geom_contour(data=constant_head_boundary,aes(x,y,z=streamfunction),bins=20,color="darkblue") +
geom_point(data=wells_constant_head,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal() + thm + ggtitle("Constant head boundary at x = 0")
gridExtra::grid.arrange(p_CH,p_NF,nrow=1)
p_CH <- ggplot() +
geom_contour(data=constant_head_boundary,aes(x,y,z=head),bins=30,linetype="dashed",color="black") +
geom_contour(data=constant_head_boundary,aes(x,y,z=streamfunction),bins=20,color="darkblue") +
geom_point(data=wells_constant_head,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal() + thm + ggtitle("Constant head boundary at x = 0")
p_NF <- ggplot() +
geom_contour(data=no_flow_boundary,aes(x,y,z=head),bins=20,linetype="dashed",color="black") +
geom_contour(data=no_flow_boundary,aes(x,y,z=streamfunction),bins=25,color="darkblue") +
geom_point(data=wells_no_flow,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal() + thm + ggtitle("No flow boundary at x = 0")
gridExtra::grid.arrange(p_CH,p_NF,nrow=1)
p_CH <- ggplot() +
geom_contour(data=constant_head_boundary,aes(x,y,z=head),bins=30,linetype="dashed",color="black") +
geom_contour(data=constant_head_boundary,aes(x,y,z=streamfunction),bins=15,color="darkblue") +
geom_point(data=wells_constant_head,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal() + thm + ggtitle("Constant head boundary at x = 0")
p_CH
p_NF <- ggplot() +
geom_contour(data=no_flow_boundary,aes(x,y,z=head),bins=12,linetype="dashed",color="black") +
geom_contour(data=no_flow_boundary,aes(x,y,z=streamfunction),bins=25,color="darkblue") +
geom_point(data=wells_no_flow,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal() + thm + ggtitle("No flow boundary at x = 0")
ggplot() +
geom_contour(data=no_flow_boundary,aes(x,y,z=head),bins=12,linetype="dashed",color="black") +
geom_contour(data=no_flow_boundary,aes(x,y,z=streamfunction),bins=25,color="darkblue") +
geom_point(data=wells_no_flow,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal() + thm + ggtitle("No flow boundary at x = 0")
p_CH <- ggplot() +
geom_contour(data=constant_head_boundary,aes(x,y,z=head),bins=30,linetype="dashed",color="black") +
geom_contour(data=constant_head_boundary,aes(x,y,z=streamfunction),bins=15,color="darkblue") +
geom_point(data=wells_constant_head,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal() + thm + ggtitle("Constant head boundary at x = 0")
p_CH
p_CH <- ggplot() +
geom_contour(data=constant_head_boundary,aes(x,y,z=head),bins=30,linetype="dashed",color="black") +
geom_contour(data=constant_head_boundary,aes(x,y,z=streamfunction),bins=10,color="darkblue") +
geom_point(data=wells_constant_head,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal() + thm + ggtitle("Constant head boundary at x = 0")
p_CH
p_CH <- ggplot() +
geom_contour(data=constant_head_boundary,aes(x,y,z=head),bins=30,linetype="dashed",color="black") +
geom_contour(data=constant_head_boundary,aes(x,y,z=streamfunction),bins=12,color="darkblue") +
geom_point(data=wells_constant_head,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal() + thm + ggtitle("Constant head boundary at x = 0")
p_CH
p_CH <- ggplot() +
geom_contour(data=constant_head_boundary,aes(x,y,z=head),bins=30,linetype="dashed",color="black") +
geom_contour(data=constant_head_boundary,aes(x,y,z=streamfunction),bins=13,color="darkblue") +
geom_point(data=wells_constant_head,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal() + thm + ggtitle("Constant head boundary at x = 0")
p_CH
thm <- theme(axis.text=element_blank(),axis.title=element_blank(),axis.ticks=element_blank(),
panel.background = element_rect(fill=NA,color="black"),
panel.border = element_rect(fill=NA,color="black"),
plot.title = element_text(size=12))
p_CH <- ggplot() +
geom_contour(data=constant_head_boundary,aes(x,y,z=head),bins=30,linetype="dashed",color="black") +
geom_contour(data=constant_head_boundary,aes(x,y,z=streamfunction),bins=13,color="darkblue") +
geom_point(data=wells_constant_head,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal() + thm + ggtitle("Constant head boundary at x = 0")
p_CH
ggplot() +
geom_contour(data=constant_head_boundary,aes(x,y,z=head),bins=30,linetype="dashed",color="black") +
geom_contour(data=constant_head_boundary,aes(x,y,z=streamfunction),bins=13,color="darkblue") +
geom_point(data=wells_constant_head,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal() + thm + ggtitle("Constant head boundary at x = 0")
ggplot() +
geom_contour(data=constant_head_boundary,aes(x,y,z=head),bins=50,linetype="dashed",color="black") +
geom_contour(data=constant_head_boundary,aes(x,y,z=streamfunction),bins=25,color="darkblue") +
geom_point(data=wells_constant_head,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal() + thm + ggtitle("Constant head boundary at x = 0")
ggplot() +
geom_contour(data=no_flow_boundary,aes(x,y,z=head),bins=25,linetype="dashed",color="black") +
geom_contour(data=no_flow_boundary,aes(x,y,z=streamfunction),bins=50,color="darkblue") +
geom_point(data=wells_no_flow,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal() + thm + ggtitle("No flow boundary at x = 0")
p_CH <- ggplot() +
geom_contour(data=constant_head_boundary,aes(x,y,z=head),bins=50,linetype="dashed",color="black") +
geom_contour(data=constant_head_boundary,aes(x,y,z=streamfunction),bins=25,color="darkblue") +
geom_point(data=wells_constant_head,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal() + thm + ggtitle("Constant head boundary at x = 0")
p_NF <- ggplot() +
geom_contour(data=no_flow_boundary,aes(x,y,z=head),bins=25,linetype="dashed",color="black") +
geom_contour(data=no_flow_boundary,aes(x,y,z=streamfunction),bins=50,color="darkblue") +
geom_point(data=wells_no_flow,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal() + thm + ggtitle("No flow boundary at x = 0")
p_NF <- ggplot() +
geom_contour(data=no_flow_boundary,aes(x,y,z=head),bins=25,linetype="dashed",color="black") +
geom_contour(data=no_flow_boundary,aes(x,y,z=streamfunction),bins=50,color="darkblue") +
geom_point(data=wells_no_flow,aes(x,y,fill=well_type),size=3,shape=21) +
theme(legend.position=c(0.8,0.1),legend.title=element_blank()) +
coord_equal() + thm + ggtitle("No flow boundary at x = 0")
gridExtra::grid.arrange(p_CH,p_NF,nrow=1)
?egg::ggarrange
install.packages("egg")
?egg::ggarrange
